# Rapid7 Nexpose Insecure Java Keystore Password Generation

## Vendors

* Rapid7

## Affected Products

Rapid7 Nexpose versions after 6.4.50.

## Summary

The Rapid7 Nexpose product uses an insufficient algorithm when generating a random keystore password which could result in the password length being weak. An attacker that is able to recover the plaintext password to read the keystore can decrypt saved encrypted credentials used by the scanner. This vulnerability was tested on the latest version (8.24.0 at the time of testing) and likely affects all versions after version 6.4.50 where the fix for CVE-2017-5230 was implemented.

## Remediation/Mitigation

Rapid7 is targeting February 9th, 2026, for releasing the fix.

Atredis recommends restricting access to Nexpose backup files to only those that require access to perform job functions.

## Credit

This issue was found by Justin Kennedy, Stephen Breen, and Phil Brass of Atredis Partners.

## References

* https://www.cve.org/CVERecord?id=CVE-2026-1814
* https://www.rapid7.com/blog/post/ve-insightvm-nexpose-vulnerability-cve-2026-1814-fixed

## Report Timeline

* 2025-10-21: Atredis submits vulnerability through Rapid7's disclosure form. 
* 2025-10-21: Automated response from Rapid7 acknowledging they received the request and a ticket was created.
* 2025-10-24: Atredis contacts Rapid7 to confirm receipt of the vulnerability disclosure report.
* 2025-10-24: Rapid7 responds and confirms receipt of the vulnerability disclosure and that they are investigating.
* 2025-11-19: Atredis contacts Rapid7 to check Rapid7 can verify the issue on their side. Atredis also provides Rapid7 with a link to the Atredis disclosure policy and informs Rapid7 that we were will following it to publicly disclose the issue after 90 days.
* 2025-11-20: Rapid7 confirms the vulnerability and they are working with internal teams to get it remediated.
* 2025-12-03: Atredis asks Rapid7 if Rapid7 will be assigning a CVE for this vulnerability or if Atredis should start that process.
* 2025-12-03: Rapid7 responds that their engineering team made updates to the code to fix the issue and shares the updated code snippets.
* 2025-12-03: Atredis reviews the provided code, downloads the latest version of NeXpose, but does not see the updated code released. Atredis responds to Rapid7 and asks if the engineer team has already pushed out the code and if so, what version contains the fix. Atredis also asks about the CVE again and if Rapid7 has any concerns with the disclosure timeline.
* 2025-12-10: Atredis checks with Rapid7 again on the questions asked on December 3rd, 2025, reiterating the request for a CVE, and checking if there are any concerns with the disclosure timeline.
* 2025-12-11: Rapid7 responds that the engineer working on the fix is no longer with the company and the security team is working with the manager to get answers.
* 2025-12-11: Atredis thanks Rapid7 for the update.
* 2025-12-19: Atredis checks in with Rapid7 to see if there are any updates. Atredis also informs the Rapid7 contact that Rapid7 is a CNA and should be able to issue a CVE. Atredis checks to see if Rapid7 is following that process internally or if Atredis should move forward with obtaining the CVE.
* 2025-12-31: Rapid7 responds that due to resource changes that they are running into constraints, that they expect work to resume in January but likely will not meet the January 19th target. Rapid7 tells Atredis they will notify Atredis once a new engineer is assigned and that once a solution is implemented, they can move forward with the CVE process.
* 2026-01-09: Atredis responds that we can push public disclosure to the end of January 2026 and asks if that gives Rapid7 enough time to complete and release a patch.
* 2026-01-15: Rapid7 responds that the engineer assigned to the ticket is aiming to have started it by January 19th, but there is a low chance of the fix being live by the end of January; that it will likely run into February, but they can get a more accurate timeline once the engineer starts the work.
* 2026-01-15: Atredis confirms a more accurate timeline the following week would be great.
* 2026-01-21: Atredis checks with Rapid7 to see if an updated timeline is available.
* 2026-01-23: Rapid7 responds that the engineering team started the work but that the required changes are significant and impact the Console flow; given the sensitivity of that area, they need to ensure a solution is robust to avoid disrupting customer access. Due to these complexities, it is unlikely to be ready for the end of the month, and that they will reach back out as soon as they have solidified an implementation plan and a specific deployment date.
* 2026-01-29: Atredis informs Rapid7 that the details of this vulnerability will be released Friday, February 26th, 2026 and asks Rapid7 again if they will be assigning a CVE to this vulnerability or if Atredis should acquire one.
* 2026-02-02: Atredis forwards the email chain to cve@rapid7.com, mentioning that Atredis has been working with Rapid7 for months, and that the vulnerability has been confirmed by Rapid7 but that no CVE has been assigned. Atredis requests a CVE be assigned for this vulnerability. Atredis also states that the full details of this vulnerability will be released publicly on February 6th, 2026, with or without an assigned CVE, but would prefer to have a CVE for tracking and reference purposes.
* 2026-02-03: Rapid7 responds with a CVE (CVE-2026-1814), acknowledges the missed SLA, and asks for additional delay on disclosure.
* 2026-02-03: Atredis checks `https://www.cve.org/CVERecord?id=CVE-2026-1814` and sees that enough details have been released that it would be trivial for an attacker to reproduce the vulnerability.
* 2026-02-04: Atredis responds to Rapid7 that the CVE details released have all pertinent details of the vulnerability and asks if there is a firm ETA on the fix to be added to disclosure.
* 2026-02-04: Rapid7 agrees that enough details have been released as part of the CVE description and agrees to disclosure.
* 2026-02-05: Atredis and Rapid7 have a conference call at the request of Rapid7 to discuss a coordinated disclosure. Both parties agree to disclose on Monday, February 9th, 2026.

## Technical Details

Rapid7 Nexpose instances prior to version 6.4.50 used the static password `r@p1d7k3y$t0r3` to protect the Java keystore (`nsc.ks`) where encrypted credentials were saved. As a fix for this vulnerability, Nexpose implemented the `fixKeyStorePassword` method which checks if the keystore uses the known static password, and if so, updates the keystore password with the password generated by  the `CredentialsKeyStorePassword.generateRandomPassword()` method: 

```java
void fixKeyStorePassword() {
    try {
        CredentialsKeyStorePassword var1 = new CredentialsKeyStorePassword(new File(this.sharedDirectory, "conf"));
        if (var1.getPassword().equals("r@p1d7k3y$t0r3")) {
            KeyStoreManager.updateCredentialsKeyStorePassword("r@p1d7k3y$t0r3", CredentialsKeyStorePassword.generateRandomPassword());
            LoggerConstants.DEFAULT_LOGGER.info("Detected an insecure keystore password. Your keystore password has been reset.");
        }

    } catch (UnrecoverableKeyException | NoSuchAlgorithmException | IOException | CertificateException | KeyStoreException var2) {
        throw new RuntimeException("Failed to change the keystore passwords. Please contact support.", var2);
    }
}
```
`com/rapid7/nexpose/nsc/NSCStartupService.class`

The `CredentialsKeyStorePassword.generateRandomPassword()` method generates a random string between 6 and 11 characters in length, choosing characters from the charset stored in `var1`, and prepending the letter 'p', and uses this as the password for the Java keytore:

```java
public static String generateRandomPassword() {
    SecureRandom var0 = new SecureRandom();
    char[] var1 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*".toCharArray();
    String var10000 = RandomStringUtils.random(6 + var0.nextInt(6), 0, var1.length - 1, false, false, var1, var0);
    return "p" + var10000;
}
```
`com/rapid7/nexpose/keystore/CredentialsKeyStorePassword.class`

The vulnerability exists due to the potential for the length of the password to be short, allowing for bruteforce of the entire keyspace within a relatively short amount of time on consumer hardware. Using a single NVIDIA 4090 GPU with hashcat v6.2.6, keyspace lengths and recovery times can be seen below:

```
Hash.Mode........: 15500 (JKS Java Key Store Private Keys (SHA1))
Guess.Mask.......: p?1?1?1?1?1 [6]
Time.Estimated...: (0 secs)
Speed.#1.........: 19059.1 MH/s (2.50ms) @ Accel:64 Loops:70 Thr:256 Vec:1
```

```
Hash.Mode........: 15500 (JKS Java Key Store Private Keys (SHA1))
Guess.Mask.......: p?1?1?1?1?1?1 [7]
Time.Estimated...: (5 secs)
Speed.#1.........: 20248.0 MH/s (3.22ms) @ Accel:64 Loops:70 Thr:256 Vec:1
```

```
Hash.Mode........: 15500 (JKS Java Key Store Private Keys (SHA1))
Guess.Mask.......: p?1?1?1?1?1?1?1 [8]
Time.Estimated...: (6 mins, 48 secs)
Speed.#1.........: 20115.8 MH/s (3.22ms) @ Accel:64 Loops:70 Thr:256 Vec:1
```

```
Hash.Mode........: 15500 (JKS Java Key Store Private Keys (SHA1))
Guess.Mask.......: p?1?1?1?1?1?1?1?1 [9]
Time.Estimated...: (7 hours, 51 mins)
Speed.#1.........: 20187.9 MH/s (3.22ms) @ Accel:64 Loops:70 Thr:256 Vec:1
```
